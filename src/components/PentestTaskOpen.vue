<template>
    <div v-if="taskDetail">
        <b-row class="mb-4">
            <b-col>
                <b-button to="/pentest">Back</b-button>
            </b-col>
        </b-row>
        <b-row class="mb-3">
            <b-col cols="2" class="text-right">
                <b>Attacker</b>
            </b-col>
            <b-col cols="10" class="text-left">
                {{ taskDetail.attacker.name }}
            </b-col>
        </b-row>
        <b-row class="mb-3">
            <b-col cols="2" class="text-right">
                <b>Target</b>
            </b-col>
            <b-col cols="10" class="text-left">
                {{ taskDetail.target.name }}
            </b-col>
        </b-row>
        <b-row class="mb-3">
            <b-col cols="2" class="text-right">
                <b>Credential</b>
            </b-col>
            <b-col cols="10" class="text-left">
                {{ taskDetail.credential && taskDetail.credential.username + ' (' + taskDetail.credential.cred_type + ')' }}
            </b-col>
        </b-row>
        <b-row class="mb-4">
            <b-col cols="2" class="text-right">
                <b>Action</b>
            </b-col>
            <b-col cols="10" class="text-left">
                {{ taskDetail.action.name }}
            </b-col>
        </b-row>
        <b-row class="mb-4">
            <b-col cols="2" class="text-right">
                <b>Vulnerability</b>
            </b-col>
            <b-col cols="10" class="text-left">
                {{ taskDetail.action.vulnerability && taskDetail.action.vulnerability.name }}
            </b-col>
        </b-row>
        <b-row class="mb-4">
            <b-col cols="2" class="text-right">
                <b>Tool</b>
            </b-col>
            <b-col cols="10" class="text-left">
                {{ taskDetail.action.tool && taskDetail.action.tool.name }}
            </b-col>
        </b-row>
        <b-row class="mb-3">
            <b-col cols="2" class="text-right">
                <b>Create Date</b>
            </b-col>
            <b-col cols="10" class="text-left">
                {{ taskDetail.create_date }}
            </b-col>
        </b-row>
        <b-row class="mb-3">
            <b-col cols="2" class="text-right">
                <b>Write Date</b>
            </b-col>
            <b-col cols="10" class="text-left">
                {{ taskDetail.write_date }}
            </b-col>
        </b-row>
        <b-row class="mb-4">
            <b-col cols="2" class="text-right">
                <b>State</b>
            </b-col>
            <b-col cols="10" class="text-left">
                {{ taskResult.state }}
            </b-col>
        </b-row>
        <b-row class="mb-4">
            <b-col cols="2" class="text-right">
                <b>Command</b>
            </b-col>
            <b-col cols="10" class="text-left">
                {{ taskDetail.command }}
            </b-col>
        </b-row>
        <b-row class="mb-3">
            <b-col cols="2" class="text-right">
                <b>Output</b>
            </b-col>
            <b-col cols="10" class="text-left">
                <pre>{{ taskResult.output }}</pre>
            </b-col>
        </b-row>
    </div>
</template>

<script>
import Vuex from 'vuex'

export default {
    name: 'PentestTaskOpen',
    data() {
        return {
        }
    },
    computed: {
        ...Vuex.mapGetters('pentest', [
            'getTaskById',
            'getTaskResultByTaskId'
        ]),
        taskDetail() {
            return this.getTaskById(Number(this.$route.params.id));
        },
        taskResult() {
            return this.getTaskResultByTaskId(Number(this.$route.params.id));
        }
    }
}
</script>